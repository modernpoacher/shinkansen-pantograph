"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.redirectToAlpha=redirectToAlpha;exports.redirectToOmega=redirectToOmega;exports.redirectToEmbark=redirectToEmbark;exports.redirectToDebark=redirectToDebark;exports.redirect=redirect;exports.redirectFromAlpha=redirectFromAlpha;exports.redirectFromOmega=redirectFromOmega;exports.redirectFromEmbark=redirectFromEmbark;exports.redirectFromDebark=redirectFromDebark;exports.graphite=graphite;exports.default=void 0;var _debug=_interopRequireDefault(require("debug"));var _shinkansenRails=require("shinkansen-rails");var _shinkansenSignals=require("shinkansen-signals");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}var log=(0,_debug.default)('shinkansen:pantograph');var ALPHA={ERROR:'ALPHA_ERROR',ROUTE:'ALPHA_ROUTE',MOUNT:'ALPHA_MOUNT',FETCH:'ALPHA_FETCH',STORE:'ALPHA_STORE',QUERY:'ALPHA_QUERY',CHANGE:'ALPHA_CHANGE',SUBMIT:'ALPHA_SUBMIT'};var OMEGA={ERROR:'OMEGA_ERROR',ROUTE:'OMEGA_ROUTE',MOUNT:'OMEGA_MOUNT',FETCH:'OMEGA_FETCH',STORE:'OMEGA_STORE',QUERY:'OMEGA_QUERY',CHANGE:'OMEGA_CHANGE',SUBMIT:'OMEGA_SUBMIT'};var EMBARK={ERROR:'EMBARK_ERROR',ROUTE:'EMBARK_ROUTE',MOUNT:'EMBARK_MOUNT',FETCH:'EMBARK_FETCH',STORE:'EMBARK_STORE',CHANGE:'EMBARK_CHANGE',SUBMIT:'EMBARK_SUBMIT'};var DEBARK={ERROR:'DEBARK_ERROR',ROUTE:'DEBARK_ROUTE',MOUNT:'DEBARK_MOUNT',FETCH:'DEBARK_FETCH',STORE:'DEBARK_STORE',CHANGE:'DEBARK_CHANGE',SUBMIT:'DEBARK_SUBMIT'};var ACTION={};var STATE={};var HISTORY={push:function push(){},getCurrentLocation:function getCurrentLocation(){return{};}};function redirectToAlpha(_ref){var alpha=_ref.alpha,history=_ref.history;log('redirectToAlpha');var pathname=_shinkansenRails.Rails.to(_defineProperty({},_shinkansenSignals.Signals.ALPHA,alpha),_shinkansenSignals.Signals.ALPHA_PATTERN);var _history$getCurrentLo=history.getCurrentLocation(),currentPathname=_history$getCurrentLo.pathname;if(pathname!==currentPathname)history.push(pathname);}function redirectToOmega(_ref2){var _Rails$to2;var alpha=_ref2.alpha,omega=_ref2.omega,history=_ref2.history;log('redirectToOmega');var pathname=_shinkansenRails.Rails.to((_Rails$to2={},_defineProperty(_Rails$to2,_shinkansenSignals.Signals.ALPHA,alpha),_defineProperty(_Rails$to2,_shinkansenSignals.Signals.OMEGA,omega),_Rails$to2),_shinkansenSignals.Signals.OMEGA_PATTERN);var _history$getCurrentLo2=history.getCurrentLocation(),currentPathname=_history$getCurrentLo2.pathname;if(pathname!==currentPathname)history.push(pathname);}function redirectToEmbark(_ref3){var embark=_ref3.embark,history=_ref3.history;log('redirectToEmbark');var pathname=_shinkansenRails.Rails.to(_defineProperty({},_shinkansenSignals.Signals.EMBARK,embark),_shinkansenSignals.Signals.EMBARK_PATTERN);var _history$getCurrentLo3=history.getCurrentLocation(),currentPathname=_history$getCurrentLo3.pathname;if(pathname!==currentPathname)history.push(pathname);}function redirectToDebark(_ref4){var debark=_ref4.debark,history=_ref4.history;log('redirectToDebark');var pathname=_shinkansenRails.Rails.to(_defineProperty({},_shinkansenSignals.Signals.DEBARK,debark),_shinkansenSignals.Signals.DEBARK_PATTERN);var _history$getCurrentLo4=history.getCurrentLocation(),currentPathname=_history$getCurrentLo4.pathname;if(pathname!==currentPathname)history.push(pathname);}function redirect(_ref5){var _ref5$redirect=_ref5.redirect;_ref5$redirect=_ref5$redirect===void 0?{}:_ref5$redirect;var alpha=_ref5$redirect[_shinkansenSignals.Signals.ALPHA],omega=_ref5$redirect[_shinkansenSignals.Signals.OMEGA],embark=_ref5$redirect[_shinkansenSignals.Signals.EMBARK],debark=_ref5$redirect[_shinkansenSignals.Signals.DEBARK],history=_ref5.history;log('redirect()');if(alpha&&omega){redirectToOmega({alpha:alpha,omega:omega,history:history});}else if(embark){redirectToEmbark({embark:embark,history:history});}else if(debark){redirectToDebark({debark:debark,history:history});}else if(alpha){redirectToAlpha({alpha:alpha,history:history});}else if(omega){throw Error('Pantograph encountered a route error in `redirect()`');}}function redirectFromAlpha(_ref6){var _ref6$state=_ref6.state;_ref6$state=_ref6$state===void 0?{}:_ref6$state;var _ref6$state$Signals$A=_ref6$state[_shinkansenSignals.Signals.ALPHA];_ref6$state$Signals$A=_ref6$state$Signals$A===void 0?{}:_ref6$state$Signals$A;var route=_ref6$state$Signals$A.redirect,history=_ref6.history;log('redirectFromAlpha()');if(route)redirect({redirect:route,history:history});}function redirectFromOmega(_ref7){var _ref7$state=_ref7.state;_ref7$state=_ref7$state===void 0?{}:_ref7$state;var _ref7$state$Signals$O=_ref7$state[_shinkansenSignals.Signals.OMEGA];_ref7$state$Signals$O=_ref7$state$Signals$O===void 0?{}:_ref7$state$Signals$O;var route=_ref7$state$Signals$O.redirect,history=_ref7.history;log('redirectFromOmega()');if(route)redirect({redirect:route,history:history});}function redirectFromEmbark(_ref8){var _ref8$state=_ref8.state;_ref8$state=_ref8$state===void 0?{}:_ref8$state;var _ref8$state$Signals$E=_ref8$state[_shinkansenSignals.Signals.EMBARK];_ref8$state$Signals$E=_ref8$state$Signals$E===void 0?{}:_ref8$state$Signals$E;var route=_ref8$state$Signals$E.redirect,history=_ref8.history;log('redirectFromEmbark()');if(route)redirect({redirect:route,history:history});}function redirectFromDebark(_ref9){var _ref9$state=_ref9.state;_ref9$state=_ref9$state===void 0?{}:_ref9$state;var _ref9$state$Signals$D=_ref9$state[_shinkansenSignals.Signals.DEBARK];_ref9$state$Signals$D=_ref9$state$Signals$D===void 0?{}:_ref9$state$Signals$D;var route=_ref9$state$Signals$D.redirect,history=_ref9.history;log('redirectFromDebark()');if(route)redirect({redirect:route,history:history});}function graphite(_ref10){var _ref10$action=_ref10.action;_ref10$action=_ref10$action===void 0?ACTION:_ref10$action;var type=_ref10$action.type,_ref10$state=_ref10.state,state=_ref10$state===void 0?STATE:_ref10$state,_ref10$history=_ref10.history,history=_ref10$history===void 0?HISTORY:_ref10$history;switch(type){case OMEGA.ROUTE:redirectFromOmega({state:state,history:history});break;case EMBARK.ROUTE:redirectFromEmbark({state:state,history:history});break;case DEBARK.ROUTE:redirectFromDebark({state:state,history:history});break;case ALPHA.ROUTE:redirectFromAlpha({state:state,history:history});break;}}var Pantograph=function(){function Pantograph(){_classCallCheck(this,Pantograph);}_createClass(Pantograph,null,[{key:"ALPHA",get:function get(){return ALPHA;}},{key:"OMEGA",get:function get(){return OMEGA;}},{key:"EMBARK",get:function get(){return EMBARK;}},{key:"DEBARK",get:function get(){return DEBARK;}}]);return Pantograph;}();exports.default=Pantograph;_defineProperty(Pantograph,"graphite",graphite);